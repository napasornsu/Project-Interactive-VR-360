<html>
  <head>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.2/dist/aframe-extras.min.js"></script>
  </head>
  <body>
    <a-scene>
        <a-sky color="black"></a-sky>
    
      <a-entity id="mouseCursor" cursor="rayOrigin: mouse"></a-entity>
    
      <a-entity id="Entities"></a-entity>
    
    </a-scene>
    <script>
        const gap = 15;
        const textColor = "white"; 
        const textBGColor = "blue";
        let xPosBefore = 0;

        fetch("ghostinfo.json")
        .then(response => response.json())
        .then(ghostList => {
          console.log(ghostList)
          const parentEntity = document.getElementById("Entities");
          ghostList.forEach((ghost, index) => {
            //create entity
            const entity = document.createElement("a-entity");
            entity.setAttribute("position", `${xPosBefore + gap * ghost.gapScale} -4 -15`);
            entity.setAttribute("scale", "5 5 5")
            xPosBefore = xPosBefore + (gap * ghost.gapScale * 2)
            
            //create model
            const model = document.createElement("a-entity");
            model.setAttribute("gltf-model", "assets/" + ghost.model);
            model.setAttribute("animation-mixer", "clip:*");
            model.setAttribute("scale", String(ghost.scale) + " " + String(ghost.scale) + " " + String(ghost.scale));
            model.setAttribute("position", ghost.position);
            model.setAttribute("rotation", ghost.rotation);
            entity.appendChild(model);

            //create text field
            const textField = document.createElement("a-entity");
            textField.setAttribute("geometry", "primitive: plane; width: 1; height: 1");
            textField.setAttribute("material", "color: " + textBGColor);
            textField.setAttribute("text",
                "value: " + ghost.info + ";"
                + "align:center;" 
                + "color:" + textColor + ";"
                + "lineHeight: 55;"
                + "letterSpacing: 3;"
                
            );
            textField.setAttribute("position", "-1 1.2 1.2");
            textField.setAttribute("rotation", "0 0 0");
            entity.appendChild(textField)

            //create bg plane
            const textBG = document.createElement("a-plane");
            textBG.setAttribute("color", textBGColor);
            textBG.setAttribute("position", "0 0 0");
            textField.appendChild(textBG);

            //create name text
            const nameText = document.createElement("a-text");
            nameText.setAttribute("value", ghost.name);
            nameText.setAttribute("width", "2");
            nameText.setAttribute("color", textColor);
            nameText.setAttribute("position", "-0.4 0.4 0.01");
            textField.appendChild(nameText);

            entity.addEventListener("click", () => {
                //play sound or animation
            });

            parentEntity.appendChild(entity);
          });
          
        
        });
    </script>
  </body>
</html>
